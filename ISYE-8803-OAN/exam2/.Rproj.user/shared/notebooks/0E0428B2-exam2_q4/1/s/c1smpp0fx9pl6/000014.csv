"0","n1 <- 100"
"0","n2 <- 100"
"0","A <- as.matrix(random_miss)"
"0","r <- 2"
"0","decomp <- svd(A)"
"0","U <- decomp$u"
"0","s <- decomp$d"
"0","V <- decomp$v"
"0",""
"0","s[(r+1): length(s)] <- 0"
"0","S <-diag(s)"
"0",""
"0","#svd decomp "
"0","X <- U %*% S %*% t(V)"
"0","X0 <- X"
"0",""
"0","missing_observations <-which(A==0)"
"0","A <- ifelse(A == 0, TRUE, FALSE)"
"0","X[A]<-0"
"0","m <- sum(sum(A==0))"
"0",""
"0","# Initialization"
"0","Y <- matrix(0,n1,n2)"
"0","delta <- (n1*n2)/m"
"0","lambda <- 5"
"0","tau <- delta*lambda"
"0","# Iterations"
"0","vec <- rep(0,500)"
"0","err <- rep(0,500)"
"0","for (i in 1:500){"
"0","  decomp <- svd(Y)"
"0","  U <- decomp$u"
"0","  S <- decomp$d"
"0","  V <- decomp$v"
"0","  S_t <- S-tau"
"0","  S_t[S_t<0] <- 0"
"0","  Z_random <- U%*%diag(S_t)%*%t(V) "
"0","  P <- X-Z_random"
"0","  P[A] <- 0"
"0","  Y0 <- Y"
"0","  Y <- Z_random + delta*P"
"0","  vec[i] <- sum(sum((Y-Y0)^2))"
"0","  err[i] <- sum(sum((X0-Z_random)^2))/sum(sum((X0)^2))"
"0","}"
"0","plot(vec,type=""l"")"
