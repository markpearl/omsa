"0","library(R.matlab) "
"0","library(matlab)"
"0","n1 <- 50"
"0","n2 <- 50"
"0","A <- matrix(sample(-50:50,n1*n2, replace=TRUE),n1,n2) "
"0","r <- 2"
"0","decomp <- svd(A)"
"0","U <- decomp$u"
"0","s <- decomp$d"
"0","V <- decomp$v"
"0",""
"0","s[(r+1): length(s)] <- 0"
"0","S <-diag(s)"
"0",""
"0","X <- U %*% S %*% t(V)"
"0","X0 <- X"
"0","# Removing 20% of the observations"
"0","A <- matrix(runif(n1*n2, min = 0, max = 1),n1,n2)>0.5"
"0","X[A] <- 0"
"0","m <- sum(sum(A==0))"
"0","m"
"1","[1]"
"1"," 1238"
"1","
"
"0","# Initialization"
"0","Y <- matrix(0,n1,n2)"
"0","delta <- (n1*n2)/m"
"0","tau <- 250"
"0","# Iterations"
"0","vec <- rep(0,500)"
"0","err <- rep(0,500)"
"0","for (i in 1:500){"
"0","  decomp <- svd(Y)"
"0","  U <- decomp$u"
"0","  S <- decomp$d"
"0","  V <- decomp$v"
"0","  S_t <- S-tau"
"0","  S_t[S_t<0] <- 0"
"0","  Z <- U%*%diag(S_t)%*%t(V)"
"0","  P <- X-Z"
"0","  P[A] <- 0"
"0","  Y0 <- Y"
"0","  Y <- Y0 + delta*P"
"0","  vec[i] <- sum(sum((Y-Y0)^2))"
"0","  err[i] <- sum(sum((X0-Z)^2))/sum(sum((X0)^2))"
"0","}"
"0","#plot(vec,type=""l"")"
"0","#plot(err,type=""l"")"
"0","Ar <- as.vector(A)"
"0","Xr <- as.vector(X0)"
"0","Xr <- Xr[Ar]"
"0","Zr <- as.vector(Z)"
"0","Zr <- Zr[Ar]"
"0","#dev.off()"
"0","par(mfrow=c(1,2))"
"0","plot(Xr,type=""l"")"
