"0","create_ggplot <- function(beta_index, lambda_var) {"
"0","  betas = matrix(mod$glmnet.fit$beta)[beta_index,][[1]]"
"0","  lambdas = mod$lambda"
"0","  names(lambdas) = betas@Dimnames[[2]]"
"0","  as.data.frame(as.matrix(betas)) %>% "
"0","  tibble::rownames_to_column(""variable"") %>% "
"0","  pivot_longer(-variable) %>% "
"0","  mutate(lambda=lambdas[name]) %>% "
"0","  ggplot(aes(x=lambda,y=value,col=variable)) + "
"0","  geom_line() + "
"0","  geom_vline(xintercept = lambda_var,color='red')+"
"0","  geom_label_repel(data=~subset(.x,lambda==min(lambda)),"
"0","  aes(label=variable),nudge_x=-0.5) +"
"0","  scale_x_log10()"
"0","}"
