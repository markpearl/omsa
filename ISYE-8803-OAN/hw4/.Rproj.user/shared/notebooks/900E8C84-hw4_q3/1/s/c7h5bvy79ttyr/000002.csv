"0","Z_train = array(0,dim=c(m,10,p))"
"0","Y_train = array(0,dim=c(m,n))"
"0",""
"0","x = seq(0,1,length=203)"
"0","splinebasis_B=create.bspline.basis(c(0,1),10)"
"0","base_B=eval.basis(as.vector(x),splinebasis_B)"
"0",""
"0","for (i in 1:10){"
"0","  Z_train[,,i] = X_train[,,i] %*% base_B"
"0","}"
"0",""
"0","YB_train = nsc_train_y %*% base_B"
"0","Z_matrix = matrix(Z_train ,150,100)"
"0",""
"0","Z_stack=matrix(kronecker(diag(10),Z_train),1500,1000)"
"0","Y2B_stack = as.vector(YB_train)"
